Package: usbmuxd
Version: 2.0.2
Revision: 1
Description: USB multiplexing daemon
License: LGPL

# Dependencies:
BuildDependsOnly: true
Depends: %N2.0.6-shlibs (>= %v-%r)
BuildDepends: <<
  fink-package-precedence,
  libplist2.0.3,
  pkgconfig
<<

# Unpack Phase:
Source: https://github.com/libimobiledevice/libusbmuxd/releases/download/%v/libusbmuxd-%v.tar.bz2
Source-MD5: f1ae06b1342a7a795cc3a4fc76750f6e

# Patch Phase:
#   Fix upstream flag-passing bugs. See:
#   https://github.com/libimobiledevice/libusbmuxd/issues/111
PatchFile: %n.patch
PatchFile-MD5: b4aaa257a4cd875d6a835c1c29c5f8c2
PatchScript: <<
  %{default_script}
  # don't propagate needless BuildDepends
  perl -ni -e 'print unless /\.private/' src/libusbmuxd-2.0.pc.in
<<

# Compile Phase:
ConfigureParams: --disable-silent-rules --disable-static
CompileScript: <<
  %{default_script}
  fink-package-precedence --prohibit-bdep=%n .
<<

# Install Phase:
DocFiles: AUTHORS COPYING NEWS README.md
InstallScript: <<
  make install DESTDIR=%d
<<

SplitOff: <<
  Package:   %N2.0.6-shlibs
  Depends: libplist2.0.3-shlibs

  Files: <<
    lib/libusbmuxd-2.0.6.dylib
  <<
  Shlibs: <<
    %p/lib/libusbmuxd-2.0.6.dylib 7.0.0 %n (>= 2.0.2-1)
  <<
  DocFiles: AUTHORS COPYING NEWS README.md
<<

Splitoff2: <<
  Package:   %N2.0.6-dev
  Conflicts: %N-dev, %N2-dev
  Replaces:  %N-dev, %N2-dev
  Depends:   %N2.0.6-shlibs (= %v-%r)
  BuildDependsOnly: true
  Files: <<
    include
    lib
  <<
  DocFiles: AUTHORS COPYING NEWS README.md
<<

# Additional Info
DescDetail: <<
'usbmuxd' stands for "USB multiplexing daemon".  This daemon is in charge
of multiplexing connections over USB to an iPhone or iPod touch.  To users,
it means you can sync your music, contacts, photos, etc.  over USB. To
developers, it means you can connect to any listening localhost socket on
the device.  usbmuxd is not used for tethering data transfer, which uses a
dedicated USB interface as a virtual network device.

There is already a usbmuxd daemon running if iTunes is installed.  The
purpose of this package is mainly to offer libusbmuxd.dylib for other
programs to talk to the usbmuxd daemon.
<<
Homepage: http://www.libimobiledevice.org/
Maintainer: Karl-Michael Schindler <karl-michael.schindler@web.de>
